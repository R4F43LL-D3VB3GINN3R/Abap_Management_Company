*----------------------------------------------------------------------*
***INCLUDE Z001_LCL_EMPLOYEES.
*----------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Class CL_EMPLOYEES
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
CLASS CL_EMPLOYEES DEFINITION FINAL.

  PUBLIC SECTION. "TODOS OS MÉTODOS DESTA CLASSE SERÃO PÚBLICOS."

      METHODS:

      "-----------------------------------------------------------------------------------------------"
      "-----------------------------------------------------------------------------------------------"
      "-----------------------------------------------------------------------------------------------"

      WORK_SHIFT                      "MÉTODO PARA CÁLCULO DO BONUS SALARIAL DEVIDO AO TURNO DE TRABALHO."
      IMPORTING                       "IMPORTA  TURNO DE TRABALHO E O SALÁRIO BASE."
        WORKSHIFT TYPE ZWORKSHIFT
        LV_SAL TYPE DECIMALS
      EXPORTING
        BONUS TYPE ZBONUS,            "EXPORTA O BONUS SALARIAL."

      "-----------------------------------------------------------------------------------------------"
      "-----------------------------------------------------------------------------------------------"
      "-----------------------------------------------------------------------------------------------"

      EXTRAHOURS                      "MÉTODO PARA CALCULAR VALOR DAS HORAS EXTRAS E ACRESCÊ-LO AO SALÁRIO BRUTO"
      IMPORTING                       "IMPORTA O SALÁRIO BASE E A QUANTIDADE DE HORAS EXTRAS."
        LV_SAL TYPE DECIMALS
        EXTRAHOUR TYPE ZEXTRAHOUR
      EXPORTING
        BRUTESAL TYPE ZBRUTESAL,      "EXPORTA O SALÁRIO BRUTO."

      "-----------------------------------------------------------------------------------------------"
      "-----------------------------------------------------------------------------------------------"
      "-----------------------------------------------------------------------------------------------"

      HOLYDAYS_SUB                    "MÉTODO PARA CALCULAR SUBSÍDIO DÉCIMO E FÉRIAS."
      IMPORTING                       "IMPORTA O SALÁRIO BRUTO, O BASE E A OPÇÃO CHECKED OU NÃO DO SUBSÍDIO."
        BRUTESAL TYPE ZBRUTESAL
        LV_SAL TYPE DECIMALS
        SUBHOLYDAYS TYPE ZSUBHOLYDAYS
      EXPORTING
        LIQSAL TYPE ZLIQSAL.          "EXPORTA O SALÁRIO LÍQUIDO."

      "-----------------------------------------------------------------------------------------------"
      "-----------------------------------------------------------------------------------------------"
      "-----------------------------------------------------------------------------------------------"

  PRIVATE SECTION. "TODOS OS ATRIBUTOS DE CLASSE ESTÃO PRIVADOS E SERVEM MAIS COMO UM GUIÃO DE TRABALHO."

    DATA: ID          TYPE ZID,          "ID DO CONTRACHEQUE."
          BRUTESAL    TYPE ZBRUTESAL,    "SALÁRIO BRUTO."
          LIQSAL      TYPE ZLIQSAL,      "SALÁRIO LÍQUIDO."
          HEALTHPLAN  TYPE ZHEALTHPLAN,  "PLANO DE SAÚDE."
          SINDICAL    TYPE ZSINDICAL,    "CONTRIBUIÇÃO SINDICAL."
          TRANSPORT   TYPE ZTRANSPORT,   "TICKET TRANSPORTE."
          EXTRAHOUR   TYPE ZEXTRAHOUR,   "HORAS EXTRAS."
          DEDUCTIONS  TYPE ZDEDUCTIONS,  "DEDUÇÕES SALARIAIS."
          SECSOCIAL   TYPE ZSECSOCIAL,   "SEGURANÇA SOCIAL."
          IRS         TYPE ZIRS,         "IMPOSTO DE RENDA."
          BONUS       TYPE ZBONUS,       "BONUS SALARIAIS."
          SUBHOLYDAYS TYPE ZSUBHOLYDAYS, "SUBSÍDIO DÉCIMO E FÉRIAS."
          NOPAYLEAVE  TYPE ZNOPAYLEAVE,  "FALTAS E ATRASOS."
          WORKSHIFT   TYPE ZWORKSHIFT.   "TURNO DE TRABALHO."

    DATA: LV_SAL TYPE DECIMALS.          "SALÁRIO BASE."

ENDCLASS.

"-----------------------------------------------------------------------------------------------"
"-----------------------------------------------------------------------------------------------"
"-----------------------------------------------------------------------------------------------"

CLASS CL_EMPLOYEES IMPLEMENTATION.

"-----------------------------------------------------------------------------------------------"
"-----------------------------------------------------------------------------------------------"

  METHOD WORK_SHIFT. "MÉTODO PARA CALCULAR BONUS SALARIAL POR TURNO."

    "IMPORTA O TURNO DE TRABALHO."
    "IMPORTA O SALÁRIO BASE."

    "EXPORTA O BONUS SALARIAL."

    BONUS = '0.0'. "o BONUS É INICIALIZADO COMO ZERO."

    IF WORKSHIFT EQ 'NIGHT'.               "SE O TURNO FOR NOTURNO."
      BONUS = BONUS + ( '0.25' * LV_SAL ). "RECEBE O BONUS."
    ELSE.                                  "DO CONTRÁRIO...
      BONUS = BONUS.                       "BONUS SE MANTÉM COMO ESTÁ."
    ENDIF.                                 "ENCERRA CONDIÇÃO."

  ENDMETHOD.

"-----------------------------------------------------------------------------------------------"
"-----------------------------------------------------------------------------------------------"

  METHOD EXTRAHOURS. "MÉTODO PARA CALCULAR VALOR DAS HORAS EXTRAS.

      "IMPORTA A QUANTIDADE DE HORAS EXTRAS TRABALHADAS."
      "IMPORTA O SALÁRIO BASE."

      "EXPORTA O VALOR DAS HORAS EXTRAS."
      "EXPORTA O SALÁRIO BRUTO."

      DATA: LV_VALHR TYPE P DECIMALS 2,  "VARIÁVEL LOCAL RECEBE O VALOR DA HORA EXTRA.
            LV_VALHRS TYPE P DECIMALS 2. "VARIÁVEL LOCAL RECEBE O VALOR DAS HORAS EXTRAS CALCULADAS.

      LV_VALHR = LV_SAL / ( 8 * 22 ).   "VALOR DA HORA = SALÁRIO BASE / ( 8 HORAS TRABALHADAS * 22 DIAS ÚTEIS DO MÊS).

      IF WORKSHIFT = 'DAY'.                                       "SE FOR DURANTE O DIA...
        LV_VALHRS = LV_VALHRS + ( EXTRAHOUR * ( 2 * LV_VALHR ) ). "AS HORAS EXTRAS VALEM O DOBRO.
      ELSE.                                                       "SE FOR DURANTE A NOITE...
        LV_VALHRS = LV_VALHRS + ( EXTRAHOUR * ( 3 * LV_VALHR ) ). "AS HORAS EXTRAS VALEM O TRIPLO"
      ENDIF.

      BRUTESAL = LV_SAL + LV_VALHRS. "APROVEITAMOS E DIZEMOS QUE O SALÁRIO BRUTO RECEBE O SALÁRIO BASE + O VALOR DAS HORAS EXTRAS."

  ENDMETHOD.

"-----------------------------------------------------------------------------------------------"
"-----------------------------------------------------------------------------------------------"

  METHOD HOLYDAYS_SUB. "MÉTODO PARA CALCULAR SUBSÍDIO DÉCIMO E FÉRIAS."

    "IMPORTA O SALÁRIO BRUTO."
    "IMPORTA O SALÁRIO BASE."
    "IMPORTA O VALOR CHECKED DO SUBSÍDIO."

    "EXPORTA O SALÁRIO LÍQUIDO."

    DATA: LV_YSDF TYPE ZLIQSAL. "É CRIADA UMA VARIÁVEL LOCAL PARA RECEBER O VALOR DO SUBSÍDIO"

      IF SUBHOLYDAYS = 'X'.                    "SE OPTAR POR RECEBER O SUBSÍDIO MENSALMENTE...
        LV_YSDF = LV_YSDF + ( BRUTESAL / 12 ). "A VARIÁVEL LOCAL RECEBE O SUBSÍDIO FÉRIAS + SUBSÍDIO DÉCIMO TERCEIRO"
      ELSE.                                    "DO CONTRÁRIO...
        LV_YSDF = 0.                           "A VARIÁVEL RECEBE ZERO.
      ENDIF.

      LIQSAL = LIQSAL + LV_YSDF. "AO FINAL DO CÁLCULO SE SOMA A VARIÁVEL AO SALÁRIO LÍQUIDO."

    ENDMETHOD.
    
"-----------------------------------------------------------------------------------------------"
"-----------------------------------------------------------------------------------------------"

ENDCLASS.
